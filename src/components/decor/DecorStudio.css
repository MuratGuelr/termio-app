.decor-studio { padding: 16px; max-width: 1000px; margin: 0 auto; }
.decor-studio__header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
.decor-studio__header h1 { margin: 0; font-size: 1.5rem; }
.decor-studio__xp { margin-left: auto; font-weight: 600; }

/* House building styles */
.view-toggle { display: flex; gap: 12px; margin-bottom: 16px; justify-content: center; }
.house-building { display: flex; flex-direction: column; align-items: center; gap: 24px; padding: 40px; text-align: center; }
.building-stage h3 { margin: 0 0 16px; font-size: 1.4rem; }
.next-stage { margin-top: 16px; }
.build-actions { display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap; justify-content: center; }
.build-actions .btn { min-width: 140px; }
.hint-xp { margin-top: 6px; font-size: 0.9rem; color: #ef4444; }
.next-stage p { margin: 8px 0; }
.building-visual { margin: 20px 0; height: 300px; display: flex; justify-content: center; align-items: center; }
.house-completed { text-align: center; padding: 40px; }
.house-completed .house-visual { font-size: 4rem; margin-bottom: 16px; }
.house-completed h3 { margin: 0 0 12px; font-size: 1.4rem; }

/* House construction stages */
.house-construction {
  position: relative;
  width: 320px;
  height: 240px;
  perspective: 1200px;
  transform-style: preserve-3d;
}

/* Empty land stage */
.empty-land {
  position: relative;
  width: 100%;
  height: 100%;
}

.grass {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 50px;
  background: linear-gradient(to top, #15803d, #22c55e, #4ade80);
  border-radius: 0 0 12px 12px;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}

.grass::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 8px;
  background: repeating-linear-gradient(
    90deg,
    transparent 0px,
    transparent 2px,
    rgba(255,255,255,0.2) 2px,
    rgba(255,255,255,0.2) 3px
  );
}

.trees {
  position: absolute;
  bottom: 40px;
  right: 30px;
  display: flex;
  gap: 15px;
}

.tree {
  width: 24px;
  height: 50px;
  background: radial-gradient(ellipse at center, #65a30d, #4d7c0f);
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  position: relative;
  box-shadow: 2px 2px 8px rgba(0,0,0,0.3);
}

.tree::after {
  content: '';
  position: absolute;
  bottom: -12px;
  left: 50%;
  transform: translateX(-50%);
  width: 6px;
  height: 20px;
  background: linear-gradient(to bottom, #92400e, #78350f);
  border-radius: 3px;
  box-shadow: 1px 1px 3px rgba(0,0,0,0.4);
}

/* Purchased land stage */
.purchased-land {
  position: relative;
  width: 100%;
  height: 100%;
}

.ground {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 50px;
  background: linear-gradient(to top, #92400e, #d4a574, #e6b887);
  border-radius: 0 0 12px 12px;
  box-shadow: inset 0 3px 6px rgba(0,0,0,0.2);
}

.ground::before {
  content: '';
  position: absolute;
  top: 5px;
  left: 10%;
  right: 10%;
  height: 3px;
  background: repeating-linear-gradient(
    90deg,
    rgba(139, 69, 19, 0.6) 0px,
    rgba(139, 69, 19, 0.6) 8px,
    transparent 8px,
    transparent 12px
  );
}

.survey-markers {
  position: absolute;
  inset: 20px;
}

.marker {
  position: absolute;
  width: 8px;
  height: 8px;
  background: #ef4444;
  border-radius: 50%;
  animation: pulse 2s infinite;
}

.marker:nth-child(1) { top: 0; left: 0; }
.marker:nth-child(2) { top: 0; right: 0; }
.marker:nth-child(3) { bottom: 0; left: 0; }
.marker:nth-child(4) { bottom: 0; right: 0; }

@keyframes pulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

/* Decor canvas backdrop & interior visuals */
.decor-canvas__inner { position: relative; }
.canvas-backdrop { position: absolute; inset: 0; pointer-events: none; z-index: 0; display: flex; justify-content: center; align-items: end; }
.canvas-backdrop__img { max-width: 92%; max-height: 100%; object-fit: contain; align-self: end; opacity: 1; }
/* View-specific backdrop tuning */
.canvas-backdrop--exterior .canvas-backdrop__img { max-width: 100%; }
.canvas-backdrop--interior .canvas-backdrop__img { max-width: 92%; }
.decor-node { z-index: 1; }

/* Simple interior room */
.interior-room { position: relative; width: 520px; height: 300px; }
.interior-wall { position: absolute; background: linear-gradient(180deg, #eef2ff, #e2e8f0); }
.interior-wall--back { top: 0; left: 10%; right: 10%; height: 55%; border: 1px solid #cbd5e1; box-shadow: inset 0 -10px 30px rgba(0,0,0,0.05); }
.interior-wall--left { top: 5%; left: 0; width: 10%; height: 55%; transform: skewY(8deg); background: linear-gradient(180deg, #e5e7eb, #d1d5db); }
.interior-wall--right { top: 5%; right: 0; width: 10%; height: 55%; transform: skewY(-8deg); background: linear-gradient(180deg, #e5e7eb, #d1d5db); }
.interior-floor { position: absolute; left: 5%; right: 5%; bottom: 0; height: 45%; background: repeating-linear-gradient(90deg, #d4b090 0 20px, #c49a7a 20px 40px); transform: perspective(600px) rotateX(55deg); transform-origin: bottom; box-shadow: inset 0 10px 30px rgba(0,0,0,0.15); border-top: 2px solid rgba(0,0,0,0.05); }

/* Foundation stage */
.foundation-stage {
  position: relative;
  width: 100%;
  height: 100%;
}

.foundation {
  position: absolute;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  height: 25px;
  background: linear-gradient(to bottom, #71717a, #52525b, #3f3f46);
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.4), inset 0 2px 4px rgba(255,255,255,0.1);
}

.foundation::before {
  content: '';
  position: absolute;
  top: 3px;
  left: 8px;
  right: 8px;
  height: 2px;
  background: repeating-linear-gradient(
    90deg,
    rgba(255,255,255,0.3) 0px,
    rgba(255,255,255,0.3) 12px,
    transparent 12px,
    transparent 16px
  );
}

.rebar {
  position: absolute;
  bottom: 48px;
  left: 50%;
  transform: translateX(-50%);
  width: 190px;
  height: 12px;
  background: repeating-linear-gradient(
    90deg,
    #374151 0px,
    #374151 6px,
    transparent 6px,
    transparent 10px
  );
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.rebar::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 2px;
  background: repeating-linear-gradient(
    90deg,
    #4b5563 0px,
    #4b5563 6px,
    transparent 6px,
    transparent 10px
  );
  transform: translateY(-50%);
}

/* Walls stage */
.walls-stage {
  position: relative;
  width: 100%;
  height: 100%;
}

.wall {
  position: absolute;
  background: linear-gradient(to bottom, #f8fafc, #e2e8f0, #cbd5e1);
  border: 2px solid #94a3b8;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transform-style: preserve-3d;
}

.wall::before {
  content: '';
  position: absolute;
  top: 8px;
  left: 8px;
  right: 8px;
  bottom: 8px;
  background: repeating-linear-gradient(
    0deg,
    transparent 0px,
    transparent 15px,
    rgba(148, 163, 184, 0.3) 15px,
    rgba(148, 163, 184, 0.3) 17px
  );
  border-radius: 2px;
}

.wall--front {
  bottom: 65px;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  height: 90px;
  z-index: 4;
}

.wall--left {
  bottom: 65px;
  left: 60px;
  width: 120px;
  height: 90px;
  transform: rotateY(-35deg) translateZ(-30px);
  z-index: 2;
  background: linear-gradient(to bottom, #e2e8f0, #cbd5e1, #94a3b8);
}

.wall--right {
  bottom: 65px;
  right: 60px;
  width: 120px;
  height: 90px;
  transform: rotateY(35deg) translateZ(-30px);
  z-index: 2;
  background: linear-gradient(to bottom, #e2e8f0, #cbd5e1, #94a3b8);
}

.wall--back {
  bottom: 65px;
  left: 50%;
  transform: translateX(-50%) translateZ(-120px);
  width: 200px;
  height: 90px;
  z-index: 1;
  background: linear-gradient(to bottom, #cbd5e1, #94a3b8, #64748b);
}

.door-frame {
  position: absolute;
  bottom: 65px;
  left: 50%;
  transform: translateX(-50%);
  width: 35px;
  height: 70px;
  background: linear-gradient(to right, #1f2937, #374151, #1f2937);
  z-index: 5;
  border-radius: 6px 6px 0 0;
  box-shadow: inset 2px 0 4px rgba(0,0,0,0.3), inset -2px 0 4px rgba(0,0,0,0.3);
}

.door-frame::before {
  content: '';
  position: absolute;
  top: 15px;
  right: 4px;
  width: 4px;
  height: 4px;
  background: #fbbf24;
  border-radius: 50%;
  box-shadow: 0 0 4px rgba(251, 191, 36, 0.6);
}

.window-frame {
  position: absolute;
  bottom: 100px;
  width: 30px;
  height: 30px;
  background: linear-gradient(135deg, #7dd3fc, #0ea5e9, #0284c7);
  border: 3px solid #1e293b;
  z-index: 5;
  border-radius: 2px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3), inset 0 1px 2px rgba(255,255,255,0.3);
}

.window-frame::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 1px;
  background: #1e293b;
  transform: translateY(-50%);
}

.window-frame::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: 1px;
  background: #1e293b;
  transform: translateX(-50%);
}

.window-frame--left {
  left: 90px;
}

.window-frame--right {
  right: 90px;
}

/* Roof stage */
.roof-stage {
  position: relative;
  width: 100%;
  height: 100%;
}

.roof {
  position: absolute;
  background: linear-gradient(to bottom, #dc2626, #b91c1c, #991b1b);
  border: 2px solid #7f1d1d;
  transform-style: preserve-3d;
  box-shadow: 0 6px 12px rgba(0,0,0,0.4);
}

.roof--front {
  bottom: 155px;
  left: 50%;
  transform: translateX(-50%) rotateX(25deg);
  width: 220px;
  height: 60px;
  z-index: 6;
  clip-path: polygon(10% 100%, 90% 100%, 50% 0%);
}

.roof--left {
  bottom: 155px;
  left: 50px;
  width: 140px;
  height: 60px;
  transform: rotateY(-35deg) rotateX(25deg) translateZ(-20px);
  z-index: 5;
  background: linear-gradient(to bottom, #b91c1c, #991b1b, #7f1d1d);
  clip-path: polygon(0% 100%, 85% 100%, 50% 0%);
}

.roof--right {
  bottom: 155px;
  right: 50px;
  width: 140px;
  height: 60px;
  transform: rotateY(35deg) rotateX(25deg) translateZ(-20px);
  z-index: 5;
  background: linear-gradient(to bottom, #b91c1c, #991b1b, #7f1d1d);
  clip-path: polygon(15% 100%, 100% 100%, 50% 0%);
}

.chimney {
  position: absolute;
  bottom: 180px;
  right: 110px;
  width: 20px;
  height: 35px;
  background: linear-gradient(to right, #7c2d12, #92400e, #7c2d12);
  border: 1px solid #451a03;
  z-index: 7;
  border-radius: 2px;
  box-shadow: 2px 2px 6px rgba(0,0,0,0.4);
}

.chimney::before {
  content: '';
  position: absolute;
  top: -8px;
  left: -2px;
  right: -2px;
  height: 8px;
  background: linear-gradient(to bottom, #92400e, #7c2d12);
  border-radius: 2px 2px 0 0;
  border: 1px solid #451a03;
}

.chimney::after {
  content: '';
  position: absolute;
  top: -15px;
  left: 50%;
  transform: translateX(-50%);
  width: 8px;
  height: 8px;
  background: radial-gradient(circle, rgba(156, 163, 175, 0.8), rgba(107, 114, 128, 0.6));
  border-radius: 50%;
  animation: smoke 3s infinite ease-in-out;
}

@keyframes smoke {
  0% { opacity: 0.8; transform: translateX(-50%) translateY(0) scale(1); }
  50% { opacity: 0.4; transform: translateX(-45%) translateY(-10px) scale(1.2); }
  100% { opacity: 0; transform: translateX(-40%) translateY(-20px) scale(1.5); }
}

.roof-tiles {
  position: absolute;
  bottom: 155px;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  height: 50px;
  z-index: 8;
  background: repeating-linear-gradient(
    90deg,
    transparent 0px,
    transparent 8px,
    rgba(127, 29, 29, 0.4) 8px,
    rgba(127, 29, 29, 0.4) 10px
  );
  clip-path: polygon(15% 100%, 85% 100%, 50% 20%);
}

/* Canvas area variants */
.decor-canvas--exterior { background: linear-gradient(135deg, #e8f5e8 0%, #d4f1d4 100%); }
.decor-canvas--interior { background: linear-gradient(135deg, #f5f5dc 0%, #f0e68c 100%); }

.decor-studio__section { margin: 20px 0; }
.decor-studio__section h2 { margin: 0 0 8px; font-size: 1.2rem; }

/* Canvas */
.decor-canvas { position: relative; height: 520px; border: 1px dashed var(--border, #e5e7eb); border-radius: 12px; background: var(--surface, #fff); overflow: hidden; }
.decor-canvas--grid { background-image: 
  linear-gradient(to right, rgba(0,0,0,0.06) 1px, transparent 1px),
  linear-gradient(to bottom, rgba(0,0,0,0.06) 1px, transparent 1px);
  background-size: 16px 16px;
}
.decor-canvas__inner { position: absolute; inset: 0; width: 100%; height: 100%; transform-origin: 0 0; }
.decor-canvas__empty { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.6; font-size: 0.95rem; pointer-events: none; }
.decor-node { position: absolute; width: 48px; height: 48px; display: grid; place-items: center; cursor: default; user-select: none; touch-action: none; }
/* Allow auto-sizing when content is an image or larger visual */
.decor-node[data-decor-id] { width: auto; height: auto; }
.decor-img { display: block; width: auto; height: auto; pointer-events: none; user-select: none; }
/* Base sizes per exterior item */
.decor-node[data-decor-id="pool"] .decor-img { width: 130px; height: 78px; }
.decor-node[data-decor-id="tree"] .decor-img { width: 52px; height: 86px; }
.decor-node[data-decor-id="flower"] .decor-img { width: 64px; height: 28px; }
.decor-node[data-decor-id="garden_light"] .decor-img { width: 18px; height: 48px; }
/* Interior item base sizes */
.decor-node[data-decor-id="sofa"] .decor-img { width: 200px; height: 120px; }
.decor-node[data-decor-id="table"] .decor-img { width: 160px; height: 120px; }
.decor-node[data-decor-id="plant"] .decor-img { width: 120px; height: 160px; }
.decor-node[data-decor-id="tv"] .decor-img { width: 180px; height: 120px; }
.decor-node__icon { width: 48px; height: 48px; display: grid; place-items: center; background: var(--muted, #f3f4f6); border-radius: 10px; font-size: 28px; }
.decor-node__remove { position: absolute; top: -8px; right: -8px; width: 22px; height: 22px; border-radius: 50%; border: 1px solid var(--border, #e5e7eb); background: var(--surface, #fff); display: grid; place-items: center; font-size: 10px; cursor: pointer; }
.decor-node__size { position: absolute; left: 50%; transform: translateX(-50%); bottom: -26px; display: flex; gap: 6px; }
.decor-node__btn { width: 22px; height: 22px; border-radius: 6px; border: 1px solid var(--border, #e5e7eb); background: var(--surface, #fff); display: grid; place-items: center; font-size: 12px; cursor: pointer; }
.decor-toolbar { display: flex; justify-content: space-between; align-items: center; gap: 10px; margin-bottom: 8px; }
.toolbar-left, .toolbar-right { display: flex; gap: 8px; align-items: center; }
.zoom-indicator { min-width: 44px; text-align: center; font-variant-numeric: tabular-nums; }

.decor-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; }
.decor-card { background: var(--surface, #fff); border: 1px solid var(--border, #e5e7eb); border-radius: 10px; padding: 12px; display: flex; gap: 10px; align-items: center; }
.decor-card__thumb { width: 48px; height: 48px; display: grid; place-items: center; font-size: 28px; background: var(--muted, #f3f4f6); border-radius: 8px; }
.decor-card__img { max-width: 100%; max-height: 100%; object-fit: contain; display: block; }
.decor-card__meta { flex: 1; min-width: 0; }
.decor-card__title { font-weight: 600; }
.decor-card__desc { font-size: 0.9rem; opacity: 0.8; }
.decor-card__actions { display: flex; gap: 8px; }

.empty { padding: 16px; text-align: center; opacity: 0.7; background: var(--muted, #f3f4f6); border-radius: 8px; }

.btn { padding: 8px 12px; border-radius: 8px; border: 1px solid var(--border, #e5e7eb); background: var(--surface, #fff); cursor: pointer; }
.btn:hover { background: var(--muted, #f3f4f6); }
.btn--primary { background: var(--primary, #4f46e5); color: #fff; border-color: var(--primary, #4f46e5); }
.btn--primary:hover { filter: brightness(0.95); }

.icon-btn { width: 36px; height: 36px; display: grid; place-items: center; border-radius: 8px; border: 1px solid var(--border, #e5e7eb); background: var(--surface, #fff); cursor: pointer; }
.icon-btn:hover { background: var(--muted, #f3f4f6); }

@media (prefers-color-scheme: dark) {
  .decor-card { background: #111827; border-color: #1f2937; }
  .decor-card__thumb { background: #0b1220; }
  .empty { background: #0b1220; }
  .icon-btn, .btn { background: #111827; border-color: #1f2937; }
  .decor-canvas { background: #0b1220; border-color: #1f2937; }
  .decor-node__icon { background: #111827; }
  .decor-node__btn { background: #111827; border-color: #1f2937; }
}

/* Exterior decor visuals */
/* Fence spans across the front yard */
.decor-fence {
  position: absolute;
  left: 5%;
  right: 5%;
  bottom: 56px; /* better align with exterior_bg ground */
  height: 24px;
  z-index: 0; /* behind decor nodes, above backdrop ground */
  pointer-events: none;
}
.decor-fence::before,
.decor-fence::after { content: none; }
.decor-fence__img { width: 100%; height: 100%; object-fit: contain; display: block; filter: none; }

/* Pool */
.decor-pool {
  width: 130px;
  height: 78px;
  border-radius: 40px;
  background: radial-gradient(ellipse at 60% 40%, rgba(255,255,255,0.35), transparent 40%),
              linear-gradient(145deg, #22d3ee, #0ea5e9);
  border: 3px solid #38bdf8;
  box-shadow: 0 10px 18px rgba(0,0,0,0.28), inset 0 0 20px rgba(255,255,255,0.35);
}

/* Tree */
.decor-tree {
  position: relative;
  width: 52px;
  height: 86px;
}
.decor-tree::before {
  content: '';
  position: absolute;
  bottom: 22px;
  left: 50%;
  transform: translateX(-50%);
  width: 22px;
  height: 28px;
  background: radial-gradient(ellipse at center, #65a30d, #4d7c0f);
  border-radius: 50% 50% 40% 40% / 60% 60% 40% 40%;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.decor-tree::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 10px;
  height: 26px;
  background: linear-gradient(#92400e, #7c2d12);
  border-radius: 3px;
}

/* Flowerbed */
.decor-flowerbed {
  position: relative;
  width: 64px;
  height: 28px;
  background: #3f6212;
  border-radius: 14px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.25) inset;
}
.decor-flowerbed::before,
.decor-flowerbed::after {
  content: '';
  position: absolute;
  top: 6px;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #f472b6;
  box-shadow: 14px 0 0 #fca5a5, 28px 0 0 #60a5fa, 42px 0 0 #fbbf24;
}
.decor-flowerbed::after {
  top: 14px;
  left: 6px;
  background: #a78bfa;
  box-shadow: 14px 0 0 #34d399, 28px 0 0 #fb7185, 42px 0 0 #f59e0b;
}

/* Garden light */
.decor-garden-light {
  position: relative;
  width: 18px;
  height: 48px;
}
.decor-garden-light::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 36px;
  background: linear-gradient(#374151, #111827);
  border-radius: 2px;
}
.decor-garden-light::after {
  content: '';
  position: absolute;
  bottom: 34px;
  left: 50%;
  transform: translateX(-50%);
  width: 18px;
  height: 14px;
  background: radial-gradient(circle at 50% 60%, #fde68a, #f59e0b 70%, rgba(245, 158, 11, 0.6));
  border: 2px solid #92400e;
  border-radius: 6px 6px 2px 2px;
  box-shadow: 0 0 8px rgba(245, 158, 11, 0.7);
}

/* Pool enhancement: rim and ripple */
.decor-pool {
  position: relative;
}
.decor-pool::before {
  content: '';
  position: absolute;
  inset: -8px;
  border-radius: 46px;
  background: linear-gradient(#94a3b8, #64748b);
  box-shadow: 0 6px 12px rgba(0,0,0,0.28);
  z-index: -1;
}
.decor-pool::after {
  content: '';
  position: absolute;
  inset: 8px;
  border-radius: 32px;
  background: radial-gradient(circle at 40% 60%, rgba(255,255,255,0.35) 0 20%, transparent 22%),
              radial-gradient(circle at 70% 30%, rgba(255,255,255,0.25) 0 16%, transparent 18%);
  opacity: 0.6;
}

/* Badges for shop state */
.badge {
  display: inline-block;
  padding: 2px 8px;
  font-size: 12px;
  border-radius: 999px;
  background: var(--muted, #f3f4f6);
  color: #374151;
  border: 1px solid var(--border, #e5e7eb);
}
.badge--success {
  background: #e6f9ec;
  color: #065f46;
  border-color: #a7f3d0;
}
